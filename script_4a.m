s=tf('s');
Ts = 0.5;

Rh = 6.600000e+00;
Ch = 2.000000e-01;
CT = 3.000000e+00;
RT = 3.250000e-01;
A  = 2.500000e-02;
h_ = 3.000000e-01;
T_ = 3.300000e+01;
Ti_ = 1.800000e+01;
T2_ = 3.600000e+01;
Fc_ = 2.000000e-09;
Fi_ = 1.000000e-02;
qi_ = 1.200000e-08;

a = -((Fi_ + Fc_)/A*h_ - 1/(CT* RT));
b = -((Fi_*(Ti_ - T_) + Fc_*(T2_ - T_))/(A*(h_^2)));
c = 1/CT;
d = (T2_ - T_)/A*h_;
e = (Ti_ - T_)/A*h_;
f = (Fi_/(A*h_) - 1/(CT*RT));
g = Fc_/(A*h_);

A = [(-1)/(Rh*Ch) 0; b a];
B = [1/Ch 0; d c];
C = [0 0; b/(s + a) 0];
D = [Rh/(Rh*Ch*s + 1) 0; d/(s + a) c/(s + a)];

G_s = (C*(s*eye(2) - A)^-1)*B + D;
G_z = c2d(G_s, Ts, 'zoh');

step(G_s);
hold on;
step(G_z);
